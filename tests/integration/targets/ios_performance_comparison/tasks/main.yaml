---
- name: "Print header for config (write) test"
  ansible.builtin.debug:
    msg:
      - "=========================================="
      - "== PERFORMANCE TEST: ios_config (write) =="
      - "=========================================="

- name: "Run ios_config test with libssh"
  vars:
    ansible_network_cli_ssh_type: "libssh"
  ansible.builtin.include_tasks: run_config_test.yml

- name: "Run ios_config test with paramiko"
  vars:
    ansible_network_cli_ssh_type: "paramiko"
  ansible.builtin.include_tasks: run_config_test.yml

- name: "Print header for command (read) test"
  ansible.builtin.debug:
    msg:
      - "==========================================="
      - "==  PERFORMANCE TEST: ios_command (read) =="
      - "==========================================="

- name: "Run ios_command test with libssh"
  vars:
    ansible_network_cli_ssh_type: "libssh"
  ansible.builtin.include_tasks: run_command_test.yml

- name: "Run ios_command test with paramiko"
  vars:
    ansible_network_cli_ssh_type: "paramiko"
  ansible.builtin.include_tasks: run_command_test.yml

- name: "Print header for final cleanup"
  ansible.builtin.debug:
    msg:
      - "=========================================="
      - "==            FINAL CLEANUP             =="
      - "=========================================="

- name: "Ensure massive ACL is removed from device"
  cisco.ios.ios_config:
    lines:
      - "no ip access-list extended MASSIVE_TEST_ACL"
  changed_when: false # We don't care about the changed status for cleanup

- name: "Display final performance comparison results"
  ansible.builtin.debug:
    msg:
      - "=========================================="
      - "==       PERFORMANCE SUMMARY            =="
      - "=========================================="
      - "ios_config (write) Performance:"
      - "  Libssh:  {{ libssh_config_time }} seconds"
      - "  Paramiko: {{ paramiko_config_time }} seconds"
      - "--------------------------------------------------"
      - "ios_command (read) Performance:"
      - "  Libssh:  {{ libssh_command_time }} seconds"
      - "  Paramiko: {{ paramiko_command_time }} seconds"
      - "--------------------------------------------------"
